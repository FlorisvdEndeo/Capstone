
\usepackage[utf8]{inputenc}
\usepackage{mathtools}
\usepackage{tikz}
\usepackage{physics}
\usepackage[backend=biber, citestyle = phys, giveninits = true]{biblatex}
\usepackage{titling}
\usepackage{titletoc}
\usepackage{kbordermatrix}
\usepackage{graphicx}
\usepackage[document]{ragged2e}
\usepackage{fancyhdr}
\usepackage{bbold}
%\usepackage{tikz}
%\usetikzlibrary{quantikz}
%\usepackage{blochsphere}
\usepackage{hyperref}
\usepackage{enumitem}
\usepackage{stmaryrd}
\usepackage{subcaption}
\usepackage{import}
\usepackage{amsmath}
\usepackage{listings}
\usepackage[colorinlistoftodos]{todonotes}
\usepackage[top=1in, bottom=1in, left=1.25in, right=1.25in]{geometry}
%%% Todonotes commands %%%
\newcommand{\addref}{\todo[color=red!40]{Add reference.}}
\newcommand{\question}{\todo[color=green!40]}
\usepackage{pgfplots}
\usepackage{tikz}
\usetikzlibrary{decorations.text}
\usepackage[letterspace=150]{microtype}

\def\bracket#1#2{\langle #1 | #2 \rangle}
\def\kb#1#2{| #1 \rangle\!\langle #2 |}
\def\kbtwo#1#2#3#4{|#1 \rangle\!\langle #2 | #3 \rangle\!\langle #4 | }

\newcommand{\rephrase}{\todo[color=blue!40]{Rephrase}}

\newcommand{\Sop}{{(I - 2\dyad{\beta}{\beta}) \otimes I}}
\newcommand{\Vop}{{\sum_{j}\kb j j  \otimes P_{j}}}
\newcommand{\fiok}{{\sum_j\beta_j\ket{j }\otimes \ket{\phi_0}}}
\newcommand{\fiik}{{\frac{1}{\sqrt{1-E_0^2}}(V-E_0)\ket{\varphi_0^0}}}
\newcommand{\fiob}{{\sum_m \beta_m^* \bra{m} \otimes \bra{phi_0}}}
\newcommand{\fiib}{{\frac{1}{\sqrt{1-E_0^2}}(V-E_0) \sum_m \beta_m^* \bra{m} \otimes \bra{\phi_0}}}
\newcommand{\fact}{{\frac{1}{1 - E^2_k} (V - E_k)}}
\date{\today}
\newcommand{\facto}{{\frac{1}{\sqrt{1 - E^2_0}} (V- E_0)}}
\newcommand{\fr}{\frac{1}{\sqrt{1-E_0^2}}
%\newcommand{\fk}{\frac{1}{\sqrt{1-E_k^2}}
\newcommand{\lefta}{\bra{\beta}\otimes\bra{\phi_k}}
\newcommand{\leftb}{i\bra{\beta} \otimes \bra{\phi_k} \frac{V-E_k}{\sqrt{1-E_k^2}}}
\newcommand{\righta}{\ket{\beta}\otimes \ket{\phi_k}}
\newcommand{\rightb}{i\frac{V-E_k}{\sqrt{1-E_k^2}}\ket{\beta}\otimes  \ket{\phi_k}}


\allowdisplaybreaks




\renewcommand\S{\Set*}

\newcount\colveccount

\newcommand*\colvec[1]{
        \global\colveccount#1
        \begin{pmatrix}
        \colvecnext
}
\def\colvecnext#1{
        #1
        \global\advance\colveccount-1
        \ifnum\colveccount>0
                \\
                \expandafter\colvecnext
        \else
                \end{pmatrix}
        \fi
}
